<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.greedy.shortcut.board.model.dao.CardMapper">

	<resultMap id="memberResultSet" type="MemberDTO">
		<id column="MEM_NO" property="no" />
		<result column="MEM_NAME" property="name" />
		<result column="MEM_ID" property="email" />
		<result column="MEM_PWD" property="password" />
		<result column="PHONE" property="phone" />
	</resultMap>
	
	<resultMap id="AuthorityResultSet" type="ProjectAuthorityDTO">
		<id column="PA_NO" property="projectRoleNo"/>		<!-- 권한고유번호 -->
		<result column="PA_ROLE" property="projectRole"/>	<!-- 	회원권한 -->
		<result column="PJT_NO" property="projectNo"/>		<!-- 프로젝트번호  -->
		<result column="MEM_NO" property="memberNo"/>	
	</resultMap> 
	
	<resultMap id="CardResultSet" type="CardDTO">
		<id column="CRD_NO" property="no" />
		<result column="CRD_NAME" property="title" />
		<result column="CRD_ENROLL_DATE" property="EnrollDate" />
		<result column="CRD_DEL_YN" property="delNo" />
		<result column="BRD_NO" property="brdNo" />
		<result column="CRD_ORDER" property="order" />
		<result column="CRD_TYPE" property="type" />
		<result column="MEM_NO" property="memNo" />
		<result column="CRD_TXT" property="txt" />
	</resultMap>
	
	<resultMap id="ProjectResultSet" type="ProjectDTO">
		<id column="PJT_NO" property="pjtNo"/>
		<result column="PJT_NAME" property="projectName"/>
		<result column="PJT_START_DATE" property="projectStartDate"/>
		<result column="PJT_DEL_YN" property="projectDelYN"/>
		<result column="MEM_NO" property="memberNo"/>
		<result column="PJT_END_DATE" property="projectEndDate"/>
		<result column="PJT_COLOR" property="projectColor"/>
	</resultMap>
	
	<resultMap type="BacklogDTO" id="backlogResultMap">
		<id property="blgNo" column="BLG_NO"/>
		<result property="blgName" column="BLG_NAME"/>
		<result property="blgPri" column="BLG_PRI"/>
		<result property="blgEnrollDate" column="BLG_ENROLL_DATE"/>
		<result property="sprEndDate" column="SPR_END_DATE"/>
		<result property="pjtNo" column="PJT_NO"/>
		<result property="blgDelYn" column="BLG_DEL_YN"/>
		<result property="blgDemoMemo" column="BLG_DEMO_MEMO"/>
		<result property="blgRefMemo" column="BLG_REF_MEMO"/>
	</resultMap>
	
	<resultMap type="SprintDTO" id="SprintResultMap">
		<id property="sprNo" column="SPR_NO"/>
		<result property="sprName" column="SPR_NAME"/>
		<result property="sprStardDate" column="SPR_START_DATE"/>
		<result property="sprEndDate" column="SPR_END_DATE"/>
		<result property="sprGoal" column="SPR_GOAL"/>
		<result property="sprDelYn" column="SPR_DEL_YN"/>
		<result property="sprBlgNo" column="BLG_NO"/>
	</resultMap>
	
	<select id="selectMember" resultMap="memberResultSet" parameterType="_int">
		SELECT
       A.PJT_NAME
     , C.SPR_NO
     , D.MEM_NAME
     , E.MEM_NO
  FROM PROJECT A 
  JOIN BACKLOG B ON(A.PJT_NO = B.PJT_NO)
  JOIN SPRINT C ON (C.BLG_NO = B.BLG_NO)
  JOIN PJT_AUTHORITY E ON (A.PJT_NO = E.PJT_NO)
  JOIN MEMBER D ON (D.MEM_NO = E.MEM_NO)
  WHERE A.PJT_NO = #{pjtNo}
    AND SPR_NO = 1
	</select>
	
 </mapper>